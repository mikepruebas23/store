(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{lu3c:function(e,t,n){"use strict";n.r(t),n.d(t,"LoginModule",(function(){return w}));var o=n("ofXK"),a=n("tyNb"),i=n("mrSG"),r=n("3Pt+"),s=n("fXoL"),c=n("N/25"),l=n("I/3d"),m=n("dNgK"),u=n("Wp6s"),b=n("kmnG"),d=n("qFsG"),p=n("bTqV"),g=n("NFeN");const h=function(){return["/register"]},f=function(){return["/forgot-password"]},S=[{path:"",component:(()=>{class e{constructor(e,t,n,o){this.authSvc=e,this.afs=t,this.router=n,this._snackBar=o,this.loginForm=new r.g({email:new r.d("",[r.s.email,r.s.required]),password:new r.d("",[r.s.required,r.s.minLength(6)])}),this.hide=!0}ngOnInit(){}openSnackBar(e){this._snackBar.open(e,"OK",{duration:5e3})}onLogin(){return Object(i.a)(this,void 0,void 0,(function*(){const{email:e,password:t}=this.loginForm.value;try{const n=yield this.authSvc.login(e,t);n&&(this.checkUserIsVerified(n),this.valideUserSmash(n.uid,e,n.emailVerified),this.router.navigate(["/home"]))}catch(n){this.openSnackBar("Correo o contrase\xf1a incorrecta")}}))}checkUserIsVerified(e){e&&e.emailVerified?this.router.navigate(["/home"]):e?(this.authSvc.logout(),this.router.navigate(["/verification-email"])):this.router.navigate(["/register"])}valideUserSmash(e,t,n){return Object(i.a)(this,void 0,void 0,(function*(){let o;return o=yield this.afs.collection("users").doc(e).valueChanges().subscribe(o=>{if(null==o)try{return this.afs.doc("users/"+e).set({uid:e,email:t,emailVerified:n,role:"SUSCRIPTOR",displayName:null,photoURL:null,tagName:null,rnkPoints:0,main:null,secondary:null,state:null,switchCode:null,position:""},{merge:!0})}catch(a){console.log("ERROR: ",a)}else sessionStorage.setItem("USERDISPLAYNAME",o.displayName),sessionStorage.setItem("USEREMAIL",o.email),sessionStorage.setItem("USERMAIN",o.main),sessionStorage.setItem("USERSECONDARY",o.secondary),sessionStorage.setItem("USERSTATE",o.state),sessionStorage.setItem("USERSWITCHCODE",o.switchCode),sessionStorage.setItem("USERTAGNAME",o.tagName),sessionStorage.setItem("USERUID",o.uid),sessionStorage.setItem("RNKPOINTS",o.rnkPoints),sessionStorage.setItem("USERPHOTOURL",o.photoURL)}),o}))}}return e.\u0275fac=function(t){return new(t||e)(s.Mb(c.a),s.Mb(l.a),s.Mb(a.a),s.Mb(m.a))},e.\u0275cmp=s.Gb({type:e,selectors:[["app-login"]],decls:32,vars:9,consts:[[1,"example-card"],[1,"tp-container"],[1,"card-avatar","example-header-image","m-5a"],[1,"tac"],[3,"formGroup","ngSubmit"],["appearance","outline",1,"form-group","w-100"],["matInput","","type","email","formControlName","email","placeholder","EMAIL","autocomplete","off","minlength","6",1,"form-control"],["input",""],["appearance","outline","hintLabel","Min 6 characters",1,"form-group","w-100"],["matInput","","type","password","formControlName","password","placeholder","PASSWORD","autocomplete","off",1,"form-control",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["type","submit","mat-flat-button","",1,"w-100","mt-30","green"],[1,"form-group","mt-40","tac"],[3,"routerLink"],[1,"form-group","mt-3"]],template:function(e,t){1&e&&(s.Sb(0,"mat-card",0),s.Nb(1,"mat-card-header"),s.Sb(2,"mat-card-content"),s.Sb(3,"div",1),s.Nb(4,"div",2),s.Sb(5,"h1",3),s.Bc(6,"LOGIN"),s.Rb(),s.Sb(7,"form",4),s.Zb("ngSubmit",(function(){return t.onLogin()})),s.Sb(8,"mat-form-field",5),s.Sb(9,"mat-label"),s.Bc(10,"Email"),s.Rb(),s.Nb(11,"input",6,7),s.Rb(),s.Sb(13,"mat-form-field",8),s.Sb(14,"mat-label"),s.Bc(15,"Password"),s.Rb(),s.Nb(16,"input",9),s.Sb(17,"button",10),s.Zb("click",(function(){return t.hide=!t.hide})),s.Sb(18,"mat-icon"),s.Bc(19),s.Rb(),s.Rb(),s.Rb(),s.Sb(20,"button",11),s.Bc(21,"Iniciar Sesi\xf3n"),s.Rb(),s.Rb(),s.Rb(),s.Rb(),s.Sb(22,"div",12),s.Sb(23,"p"),s.Bc(24,"Crear una cuenta "),s.Sb(25,"a",13),s.Bc(26," Registrarse"),s.Rb(),s.Rb(),s.Rb(),s.Sb(27,"div",14),s.Sb(28,"p"),s.Bc(29,"Olvidaste tu contrase\xf1a? "),s.Sb(30,"a",13),s.Bc(31," Olvide Contrase\xf1a"),s.Rb(),s.Rb(),s.Rb(),s.Rb()),2&e&&(s.Bb(7),s.ic("formGroup",t.loginForm),s.Bb(9),s.ic("type",t.hide?"password":"text"),s.Bb(1),s.Cb("aria-label","Hide password")("aria-pressed",t.hide),s.Bb(2),s.Cc(t.hide?"visibility_off":"visibility"),s.Bb(6),s.ic("routerLink",s.lc(7,h)),s.Bb(5),s.ic("routerLink",s.lc(8,f)))},directives:[u.a,u.c,u.b,r.t,r.o,r.h,b.c,b.f,d.a,r.b,r.n,r.f,r.j,p.a,b.g,g.a,a.b],styles:["@media only screen and (max-width:425px){.example-card[_ngcontent-%COMP%]{width:85%;margin:0 auto}.w-100[_ngcontent-%COMP%]{width:100%}.w-95[_ngcontent-%COMP%]{width:95%}.tac[_ngcontent-%COMP%]{text-align:center}.mt-40[_ngcontent-%COMP%]{margin-top:40px}.mt-30[_ngcontent-%COMP%]{margin-top:30px}.example-header-image[_ngcontent-%COMP%]{background-size:cover}.m-5a[_ngcontent-%COMP%]{margin:5px auto}.card-avatar[_ngcontent-%COMP%]{height:200px;width:58%;border-radius:50%;flex-shrink:0;object-fit:cover}.green[_ngcontent-%COMP%]{color:#fff;background:#03a000}}"]}),e})()}];let R=(()=>{class e{}return e.\u0275mod=s.Kb({type:e}),e.\u0275inj=s.Jb({factory:function(t){return new(t||e)},imports:[[a.c.forChild(S)],a.c]}),e})();var v=n("d3UM");let w=(()=>{class e{}return e.\u0275mod=s.Kb({type:e}),e.\u0275inj=s.Jb({factory:function(t){return new(t||e)},imports:[[o.c,R,r.q,u.d,b.e,d.b,v.b,g.b,p.b]]}),e})()}}]);